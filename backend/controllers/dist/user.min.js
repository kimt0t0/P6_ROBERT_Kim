"use strict";var User=require("../models/User"),jwt=require("jsonwebtoken");exports.signup=function(e,t,s){bcrypt.hash(e.body.password,10).then(function(s){new User({email:e.body.email,password:s}).save().then(function(){t.status(201).json({message:"Utilisateur créé !"})}).catch(function(s){t.status(400).json({error:s})})}).catch(function(s){t.status(500).json({error:s})})},exports.login=function(s,t,e){User.findOne({email:s.body.email}).then(function(e){if(!e)return t.status(401).json({message:"Paire login/mot de passe incorrecte"});bcrypt.compare(s.body.password,e.password).then(function(s){if(!s)return t.status(401).json({message:"Paire login/mot de passe incorrecte"});t.status(200).json({userId:e._id,token:jwt.sign({userId:e._id},"RANDOM_TOKEN_SECRET",{expiresIn:"24h"})})}).catch(function(s){t.status(500).json({error:s})})}).catch(function(s){return t.status(500).json({error:s})})};
//# sourceMappingURL=user.min.js.map
